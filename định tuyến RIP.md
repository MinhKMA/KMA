#Giao thức định tuyến RIP##Các đặc điểm của giao thức: - RIP là một giao thức distance – vector điển hình. Mỗi router sẽ gửi toàn bộ bảng định tuyến của nó cho router láng giềng theo định kỳ 30s/lần. Thông tin này lại tiếp tục được láng giềng lan truyền tiếp cho các láng giềng khác và cứ thế lan truyền ra mọi router trên toàn mạng. Kiểu trao đổi thông tin như thế còn được gọi là “lan truyền theo tin đồn”. (Ở đây, ta có thể hiểu router láng giềng là router kết nối trực tiếp với router đang xét).- Metric trong RIP được tính theo hop count – số node lớp 3 (router) phải đi qua trên đường đi để đến đích. Với RIP, giá trị metric tối đa là 15, giá trị metric = 16 được gọi là infinity metric (“metric vô hạn”), có nghĩa là một mạng chỉ được phép cách nguồn tin 15 router là tối đa, nếu nó cách nguồn tin từ 16 router trở lên, nó không thể nhận được nguồn tin này và được nguồn tin xem là không thể đi đến được.- RIP chạy trên nền UDP – port 520.- RIPv2 là một giao thức classless còn RIPv1 lại là một giao thức classful.- Cách hoạt động của RIP có thể dẫn đến loop nên một số quy tắc chống loop và một số timer được đưa ra. Các quy tắc và các timer này có thể làm giảm tốc độ hội tụ của RIP.- AD của RIP là 120##Routing loop là gì? <img src="http://3.bp.blogspot.com/-CMORwhGVun0/VEiJGwqUXWI/AAAAAAAACbg/AMlxM0zIHjo/s1600/53065425.img"> Trước khi network 1 bị down thì thì tất cả router đều xem đường route tới network là tốt. Router C nhận định rằng muốn tới network 1 thì phải qua router B với metric là 3Khi network 1 bị down xuống thìrouter E mới gửi 1 bản update tới A là: N1 down rồi nhưng router B, C, D không biết. Nhưng B và D có thể nhận biết được N1 down 1 cách nhanh chóng vì nó connect trực tiếp tới A nên nhận update nhanh hơn. Tuy nhiên do C không nhận được update là N1 down nến vẫn gửi 1 bản update tới B và D là đường tới N1 vẫn tồn tại. Và như thế B và D update lại bản routing table của mình là N1 vẫn tốt. Muốn đến N1 hãy đi qua C. Như thế là sai và quá trình này cứ lặp đi lặp lại (vì A sẽ gửi lại 1 update nói với B và D rằng la N1 hoạt động tốt) ===> routing loop**Nguyên nhân:**B và D có thể nhận được update từ A còn C thì không , bởi vì 1 “HÔI TỤ CHẬM” ( SLOW CONVERGENCE)Vậy **convergence** là gì : sau khi thay đổi cấu trúc liên kết thì tất cả router cần 1 time để tính toán lại các đường route của mình, và quá trình và thời gian đó gọi là TIME TO CONVERGENCE##Các giải pháp khắc phục:- SPLIT HORIZON:Router B và D nhận update về N1(down) sẽ không gửi lại update về N1 (up, sau khi nhận được từ C) tới cho router A.Split horizon được sử dụng để đảm bảo rằng thông tin về một route do một router phát ra không quay lại chính nó. Ví dụ, khi network 1 chưa down, router E gửi thông tin update đến router A. Router A sẽ không gửi lại thông tin update đến N1 quay lại E vì nếu làm như thế, đương nhiên E sẽ không dùng thông tin đó ==> lãng phí. Còn trong trường hợp route bị poison .Do có Split horizon, thông tin về route đến N1 không bị lặp đi lặp lại trên link giữa A và E (count-to-infinite)Split horizon with Poison reverse : Bình thường, A không gửi lại cho E thông tin về route đến N1. Nhưng khi A nhận được bản tin update nói rằng route đến N1 là unreachable –> A gửi lại cho E thông tin về route đến N1 với metric là infinite.- HOLD DOWN TIMER :Khi router nhận được thông tin về một route là unreachable, router sẽ đánh dấu route đó và đặt nó vào trạng thái hold-down (Router đặt bộ định thời = thời gian hold-down). Trong thời gian hold-down, router vẫn tiếp tục dùng route đó để forward gói tin, nhưng sẽ bỏ qua tất cả các thông tin về route với thông số metric bằng hoăc xấu hơn metric router đang có về route đó .Hold-down timer bị reset khi thời gian hold-down đã hết, hoặc router nhận được thông tin về route với metric tốt hơn metric nó đang giữ.Ví dụ: Khi A nhận được thông tin route đến N1 bị down, hold-down timer cho route đó được thiết lập. Tương tự với B, D. Do đó khi D nhận được update từ C, vì metric mà C gửi lớn hơn (xấu hơn) metric D đang có về route N1 nên D bỏ qua ==> Không còn loop- POSION REVERSE UPDATE :Là bản update đặc biệt được gửi từ router connect với 1 network down tới các router neighbor của mình ( khong bao gồm router có network bị down ) rằng đường route tới network đó là infinity.Khi một router phát hiện ra một route R bị down (router không nhận được bản tin update từ router neighbor mà từ đó nó học được route R), router sẽ đặt giá trị metric của route R bằng giá trị không xác định (infinite) và gửi đi trong bản tin cập nhật định tuyến để thông báo với các router trên mạng rằng route R unreachable.Trong hình vẽ, router E không nhận được thông tin về route đến N1, nó đặt metric của route đến N1 là infinite rồi gửi đi trong bản tin định tuyến. Đồng thờ, E hủy bỏ route đến N1 trong bảng định tuyến của nó.- IGGER UPDATE:Trigger updates là bản update được gửi ngay khi có route bị fail, không cần chờ đến thời gian định kỳ để gửi update.